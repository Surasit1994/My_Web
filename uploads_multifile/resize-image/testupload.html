<!DOCTYPE html>
<html>

<head>
    <title>คลังรูปภาพ กิจกรรมโรงพยาบาลรัตนวาปี</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">

    <style type="text/css">
        body {
            font-family: 'Sarabun', sans-serif;
            /*background-color: rgba(225, 242, 245, 0.836);*/
        }
    </style>
    <script type="text/javascript">
        var data_folder_name_old;
        //-----------------ฟังค์ชั่นดึงข้อม฿ล part file จาก server--------------------
        function get1_part(data_part1) {
            return $.ajax({
                url: 'call_dir3.php',
                type: 'get', //หรือ post (ค่าเริ่มต้นเป็นแบบ get)
                data: {
                    index_link: data_part1
                },
                dataType: 'json', //หรือ json หรือ xml
            });
        }
        //--------------โหลดเมนู โฟล์เดอร์มาแสดงใน dropdown-------------------------
        function create_option_menu(folder_name) {
            var x = document.createElement("OPTION");
            x.setAttribute("value", folder_name);
            var t = document.createTextNode(folder_name);
            x.appendChild(t);
            document.getElementById("old_name_activity").appendChild(x);
        }
        function first_load_all() {
            // alert('first load');
            var part_first = 'uploads';
            var promise = get1_part(part_first);
            promise.done(function (part_dir) {
                data_folder_name_old = part_dir;

                for (i in data_folder_name_old) { //----------------เพิ่มรายการเข้าไปใน dropdown ----------//
                    if (data_folder_name_old[i] == '0_Welcome_0') continue;
                    create_option_menu(data_folder_name_old[i]);
                }


            });
        }
        window.onload = first_load_all();
        function myFunction() { //------------------เปิดปิด input text box เมื่่อมีการกด checked------------/
            if (document.getElementById("new_activity").checked == false) {
                document.getElementById("name_activity").disabled = true;
                document.getElementById("check_name_btn").disabled = true;
                document.getElementById("old_name_activity").disabled = false;
                document.getElementById("input_file").disabled = false;
                document.getElementById('name_activity').value = ''
                //alert('unchecked!');
            } else {
                document.getElementById("name_activity").disabled = false;
                document.getElementById("check_name_btn").disabled = false;
                document.getElementById("old_name_activity").disabled = true;
                document.getElementById("input_file").disabled = true;
                document.getElementById('name_activity').focus();
                document.getElementById('name_activity').value = ''
                // alert('checked');
            }
        }
        var status_check_name = 'default';
        function check_name(name) { //-------------ฟังก์ชั่นกำหนดตรวจสอบชื่อซ้ำ-----------------------//
            console.log(name);
            if (name == '') {
                status_check_name = 'false';
                document.getElementById("name_activity").style = "background : #FF625D";//-----สีแดง---//
                document.getElementById("input_file").disabled = true;
                document.getElementById("btn_upload").disabled = true;
                console.log('true');
                alert("ไม่ได้ตั้งชื่อ กรุณาตั้งชื่อใหม่หรือเลือกจาก เมนู dropdown !!!");
                document.getElementById('name_activity').focus();
            } else {
                for (i in data_folder_name_old) {
                    if ((name == data_folder_name_old[i])) {
                        status_check_name = 'false';
                        document.getElementById("name_activity").style = "background : #FF625D";//-----สีแดง---//
                        console.log('true');
                        document.getElementById("input_file").disabled = true;
                        document.getElementById("btn_upload").disabled = true;
                        alert("ชื่อที่กำหนด มีอยู่แล้ว กรุณาเปลี่ยนชื่อใหม่หรือเลือกจาก เมนู dropdown !!!");
                        document.getElementById('name_activity').focus();
                        break;
                    }
                    else {
                        console.log('false');
                        document.getElementById("name_activity").style = "background : #B5FF95";//--สีเขียว---//
                        status_check_name = 'true';
                        document.getElementById("input_file").disabled = false;
                        document.getElementById("btn_upload").disabled = false;
                    }
                }
            }
        }

        function check_input(data_form) {
            console.log('enter check_input');
            if ((status_check_name == 'default' | status_check_name == 'false') & document.getElementById("new_activity").checked == true) {
                status_check_name = 'false';
                document.getElementById("name_activity").style = "background : #FF625D";//-----สีแดง---//
                alert("ชื่อที่กำหนด มีอยู่แล้ว หรือไม่ได้ตั้งชื่อ กรุณาเปลี่ยนชื่อใหม่หรือเลือกจาก เมนู dropdown !!! form check_input");
                document.getElementById('name_activity').focus();

            } else {
                console.log("Input is normal");
                if (status_check_name == 'true' & document.getElementById('name_activity').value != '') {
                    var cr = create_folder(document.getElementById('name_activity').value);
                    cr.done(function (response) {
                        console.log('Status Create folder : ' + response);
                    });
                }
                else {

                }
            }
        }

        function create_folder(folder_name) {
            return $.ajax({
                type: "POST",
                url: 'create_folder.php',
                dataType: 'text',
                data: {
                    name: folder_name
                }
            });
        }

    </script>
</head>

<body>
    <div class="container-lg">
        <!---------------------------Image first page ----------------------------------------->
        <img src="./images/head-index.png" class="img-fluid" alt="Welcome">
        <!---------------------------Menu navbar-------------------------------->
        <nav id="top_page" class="navbar navbar-expand-lg navbar-dark " style="background-color:#1e9bee">
            <div class="container-fluid">
                <a class="navbar-brand" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30"
                        fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
                        <path
                            d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
                    </svg></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link " aria-current="page" href="#">Home</a>
                        </li>
                        <!--<li class="nav-item">
              <a class="nav-link" href="#">Link</a>
            </li> -->
                    </ul>
                    <!--
                       <form class="d-flex">
                            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                             <button class="btn btn-outline-primary" type="submit">Search</button>
                        </form>
          -->
                </div>
            </div>
        </nav>
        <!------------------------------------Body content------------------------------------------>
        <div id="main_div" class="container-fluid " style="background-color: rgba(214, 246, 252, 0.836); ">
            <input type="file" id="upload" accept=".jpg, .jpeg, .png" multiple />
            <button onclick="process()">Process</button>
            <button onclick="check_input()">check_input</button>
            <div id="loadingmessage" class="collapse">
                <button class="btn btn-primary" type="button" disabled>
                    <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                    Uploading...
                </button>
            </div>
            <div>
                <img id="input" />
            </div>
            <div id="output">
            </div>
            <div id="output2">
            </div>
            <script src="app.js"></script>
            <!--------------------------------------------------------------------------------------------------------->
            <div class="row justify-content-center ">
                <div class="col-sm-12 col-lg-10 bg-light mx-auto border">
                    <div class="row justify-content-center ">
                        <!-------------------------------------form upload images---------------------------------->
                        <form enctype="application/json" name="create_upload_image_Form"
                            onsubmit="return check_input(this)">
                            <div class="d-grid gap-2 col-lg-8 col-sm-12 mx-auto justify-content-center ">
                                <p class="text-center text-lg fs-4 text-primary">อัพโหลดรูปภาพกิจกรรม</p>
                                <div class=" form-check">
                                    <input type="checkbox" class="form-check-input" id="new_activity"
                                        onclick="myFunction()">
                                    <label class="form-check-label" for="new_activity">กิจกรรมใหม่</label>
                                </div>
                                <input class="form-control form-control-sm" type="text" id="name_activity"
                                    name="name_activity" maxlength="80" required disabled
                                    onchange="check_name(this.value)">
                                <div class="d-grid gap-2 col-3 mx-auto">
                                    <button id="check_name_btn" class="btn btn-sm btn-success" type="button" onclick="check_name(document.getElementById('name_activity').value)" disabled>ตรววสอบชื่อ</button>
                                </div>
                                <div id="name_folder_help" class="form-text">
                                    ตั้งชื่อกิจจกรมให้เข้าใจง่ายกะทัดรัด ***หมายเหตุ
                                    (หากต้องการเว้นวรรคให้ใช้เครื่องหมายขีดล่างแทน " _ ")
                                </div>
                                <select id="old_name_activity" name="old_name_activity"
                                    class="form-select form-select-sm" aria-label=".form-select-sm example" required>
                                    <option value="">กรุณาเลือกชื่อกิจกรรม</option>
                                </select>
                                <input class="form-control form-control-sm" type="file" id="input_file" name="filename"
                                    multiple required>
                                <div class="d-grid gap-2 col-2 mx-auto">
                                    <button class="btn btn-primary" type="submit" id="btn_upload" value='Upload'
                                        name='upload'>อัพโหลด</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <br>
                </div>
            </div>
        </div>
        <!-----------------------------End----Body content------------------------------------------>
        <!----------------------Footer-------------------------------------------------------------->
        <!-- Footer -->
        <footer class=" text-center text-lg-start">
            <!-- Grid container -->
            <div id="foot" class="container-fluid p-4 border-top-0"
                style="background-color: rgba(214, 246, 252, 0.836);">
                <!--Grid row-->
                <div class="row">
                    <!--Grid column-->
                    <div class="col-lg-12 col-md-12 mb-4 mb-md-0">
                        <h5>ติดต่อ</h5>
                        <p>
                            1.Email โรงพยาบาล : <a
                                href="mailto:Rattanawapi.hospital@gmail.com ">Rattanawapi.hospital@gmail.com
                            </a><br>
                            2.Facebook โรงพยาบาล :<a target="_blank"
                                href="https://www.facebook.com/rtnhospital/">https://www.facebook.com/rtnhospital/</a><br>
                            3.โทร. : <a href="tel:042-414824">042-414824</a> <br>
                            4.ที่อยู่โรงพยาบาล : 317 หมู่ 11 ต.รัตนวาปี อ.รัตนวาปี จ.หนองคาย
                        </p>
                    </div>
                    <!--Grid column-->
                </div>
                <!--Grid row-->
            </div>
            <!-- Grid container -->
            <!-- Copyright -->
            <div class="text-center p-3" style="background-color:#0099ff;">
                © 2021 Copyright:
                <a class="text-dark" href="http://113.53.232.202/h4316/">โรงพยาบาลรัตนวาปี</a>
            </div>
            <!-- Copyright -->
        </footer>
        <!-- Footer -->
        <!--------------------END--Footer----------------------------------------------------------->
    </div>
</body>

</html>